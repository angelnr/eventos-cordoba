# API Testing para eventos-cordoba
# Usar con extensi√≥n REST Client en VS Code

@baseUrl = http://localhost:3001
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJhZG1pbkBleGFtcGxlLmNvbSIsImlhdCI6MTc2NTQ3ODU2NSwiZXhwIjoxNzY1NDc5NDY1fQ.aMq90qn0tLjshvmf4hvFylScGcAE7OMIh3sML6svE80
@token_user2 = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIiwiaWF0IjoxNzY1NDUyNDQ2LCJleHAiOjE3NjU0NTMzNDZ9.znqbUDJL1V-axz3V5ENHzwatBYwHPqHzBCt8eQJ0G8w
### ============================================================================
### üîê AUTENTICACI√ìN
### ============================================================================

### Login con usuario admin
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "admin123"
}

### Login con usuario regular
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "user123"
}

### Registro de nuevo usuario
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "email": "nuevo@example.com",
  "password": "password123",
  "name": "Usuario Nuevo"
}

### Verificar token JWT
POST {{baseUrl}}/api/auth/verify
Content-Type: application/json

{
  "token": "{{token}}"
}

### ============================================================================
### üë• USUARIOS CRUD
### ============================================================================

### Obtener perfil propio (requiere token)
GET {{baseUrl}}/api/users/me
Authorization: Bearer {{token}}

### Listar todos los usuarios (requiere token)
GET {{baseUrl}}/api/users
Authorization: Bearer {{token}}

### Obtener usuario espec√≠fico por ID (requiere token)
GET {{baseUrl}}/api/users/1
Authorization: Bearer {{token}}

### Crear nuevo usuario (sin autenticaci√≥n)
POST {{baseUrl}}/api/users
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "test123",
  "name": "Usuario de Test"
}

### Actualizar usuario (requiere token del propietario)
PUT {{baseUrl}}/api/users/1
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "name": "Usuario Admin Actualizado",
  "email": "admin@example.com"
}

### Eliminar usuario (requiere token del propietario)
DELETE {{baseUrl}}/api/users/1
Authorization: Bearer {{token}}

### ============================================================================
### ü§ñ GENERACI√ìN DE USUARIOS DE PRUEBA
### ============================================================================

### Generar 3 usuarios de prueba
POST {{baseUrl}}/api/users/generate
Content-Type: application/json

{
  "count": 3
}

### Generar 10 usuarios de prueba
POST {{baseUrl}}/api/users/generate
Content-Type: application/json

{
  "count": 10
}

### ============================================================================
### üìä ENDPOINTS P√öBLICOS
### ============================================================================

### Health Check
GET {{baseUrl}}/health

### Test endpoint
GET {{baseUrl}}/api/test

### ============================================================================
### ‚ùå PRUEBAS DE ERRORES
### ============================================================================

### Login con credenciales incorrectas
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "wrongpassword"
}

### Acceso sin token (debe fallar)
GET {{baseUrl}}/api/users
Authorization: Bearer invalid_token

### Usuario no encontrado
GET {{baseUrl}}/api/users/99999
Authorization: Bearer {{token}}

### Crear usuario con email duplicado
POST {{baseUrl}}/api/users
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "password123"
}

### Actualizar usuario sin permisos (usuario 2 intentando actualizar usuario 1)
PUT {{baseUrl}}/api/users/1
Authorization: Bearer {{token_user2}}
Content-Type: application/json

{
  "name": "Intento de hack"
}

### Generar m√°s usuarios de los permitidos
POST {{baseUrl}}/api/users/generate
Content-Type: application/json

{
  "count": 100
}

### ============================================================================
### üé≠ EVENTOS CRUD
### ============================================================================

### Listar todos los eventos (p√∫blico)
GET {{baseUrl}}/api/events

### Listar eventos con filtros
GET {{baseUrl}}/api/events?category=1&status=active&limit=5

### Buscar eventos
GET {{baseUrl}}/api/events?search=m√∫sica

### Eventos por p√°gina
GET {{baseUrl}}/api/events?page=1&limit=2

### Obtener evento espec√≠fico
GET {{baseUrl}}/api/events/1

### Crear evento (requiere token organizer/admin)
POST {{baseUrl}}/api/events
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Concierto de Rock C√≥rdoba",
  "description": "Gran concierto de rock con bandas locales",
  "date": "2025-08-15T20:00:00Z",
  "location": "Estadio Kempes, C√≥rdoba",
  "capacity": 10000,
  "price": 75.00,
  "categoryId": 1
}

### Actualizar evento (solo organizador del evento)
PUT {{baseUrl}}/api/events/1
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "title": "Concierto de Rock C√≥rdoba - Actualizado",
  "price": 85.00
}

### Eliminar evento (solo organizador del evento)
DELETE {{baseUrl}}/api/events/1
Authorization: Bearer {{token}}

### Eventos organizados por el usuario actual
GET {{baseUrl}}/api/events/my-events/organized
Authorization: Bearer {{token}}

### ============================================================================
### üë• GESTI√ìN DE USUARIOS (ADMIN)
### ============================================================================

### Eliminar usuario (solo admin)
DELETE {{baseUrl}}/api/users/3
Authorization: Bearer {{token}}

### ============================================================================
### üéØ CATEGOR√çAS
### ============================================================================

### Listar categor√≠as (p√∫blico)
GET {{baseUrl}}/api/categories

### ============================================================================
### üìä DIAGN√ìSTICO DE BASE DE DATOS
### ============================================================================

### Probar conexi√≥n a base de datos
POST {{baseUrl}}/api/auth/db-test
Content-Type: application/json

{}

### ============================================================================
### üí° INSTRUCCIONES DE USO
### ============================================================================
#
# 1. Instalar extensi√≥n "REST Client" en VS Code
# 2. Abrir este archivo (.rest)
# 3. Hacer click en "Send Request" sobre cualquier petici√≥n
# 4. Para usar variables como {{token}}, definirlas en la respuesta de login
# 5. Las respuestas se mostrar√°n en una nueva pesta√±a
#
# Variables disponibles:
# - {{baseUrl}}: URL base del servidor
# - {{token}}: Token JWT obtenido del login (admin@example.com / admin123)
# - {{token_user2}}: Token del segundo usuario (si es necesario)
#
# ============================================================================
